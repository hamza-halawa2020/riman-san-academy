<div class="container mt-5 mb-5">
  <div class="alert alert-warning text-center" *ngIf="error" role="alert">
    {{ error }}
  </div>
  <div class="">
    <div class="h1 mb-4">certificates</div>
    <p class="mb-4">Add certificates</p>

    <form
      class="bg-white py-5"
      [formGroup]="submitForm"
      (ngSubmit)="Submitted()"
    >
      <div class="col-lg-12 col-sm-12 mb-3">
        <input
          type="file"
          class="form-control"
          id="exampleInputEmail1"
          aria-describedby="emailHelp"
          placeholder="icon"
          formControlName="file"
          (change)="saveImageToDataBase($event)"
        />

        <div
          class="form-text text-success"
          *ngIf="file.valid && (file.touched || file.dirty)"
        >
          <i class="fas fa-check"></i> Looks good!
        </div>
        <div
          class="form-text text-danger"
          *ngIf="file.errors?.['required'] && (file.dirty || file.touched)"
        >
          <i class="fas fa-exclamation-circle"></i> file is required.
        </div>
      </div>
      <div class="col-lg-12 col-sm-12 mb-3">
        <input
          type="text"
          class="form-control"
          id="exampleInputEmail1"
          aria-describedby="emailHelp"
          placeholder="Serial Number"
          formControlName="serial_number"
        />

        <div
          class="form-text text-success"
          *ngIf="
            serial_number.valid &&
            (serial_number.touched || serial_number.dirty)
          "
        >
          <i class="fas fa-check"></i> Looks good!
        </div>
        <div
          class="form-text text-danger"
          *ngIf="serial_number.errors?.['required'] && (serial_number.dirty || serial_number.touched)"
        >
          <i class="fas fa-exclamation-circle"></i> serial_number is required.
        </div>
      </div>

      <div class="containermt-5 mb-5">
        <button
          type="submit"
          [disabled]="submitForm.invalid"
          class="btn btn-primary"
        >
          Send
        </button>
      </div>
    </form>
  </div>

  <div class="container mt-5 mb-5">
    <div class="">
      <div class="container">
        <table class="table">
          <thead>
            <tr>
              <th>ID</th>
              <th>serial_number</th>
              <th>File</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let certificate of certificates">
              <td>{{ certificate.id }}</td>

              <td>{{ certificate.serial_number }}</td>
              <td>
                <a target="_blank" href="{{ apiImage + certificate.file }}"
                  >Open File</a
                >
              </td>

              <td>
                <!-- Button trigger modal -->
                <button
                  type="button"
                  class="btn btn-primary"
                  data-bs-toggle="modal"
                  data-bs-target="#exampleModal"
                  [attr.data-bs-target]="'#exampleModal' + certificate.id"
                >
                  Delete
                </button>

                <!-- Modal -->
                <div
                  class="modal fade"
                  [id]="'exampleModal' + certificate.id"
                  tabindex="-1"
                  aria-labelledby="exampleModalLabel"
                  aria-hidden="true"
                >
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">
                          Confirmation
                        </h5>
                        <button
                          type="button"
                          class="btn-close"
                          data-bs-dismiss="modal"
                          aria-label="Close"
                        ></button>
                      </div>
                      <div class="modal-body">
                        Are you sure you want to delete this item?
                      </div>
                      <div class="modal-footer">
                        <button
                          type="button"
                          class="btn btn-secondary"
                          data-bs-dismiss="modal"
                        >
                          Cancel
                        </button>
                        <button
                          type="button"
                          class="btn btn-danger"
                          data-bs-dismiss="modal"
                          (click)="deletecertificate(certificate.id)"
                        >
                          Delete
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
